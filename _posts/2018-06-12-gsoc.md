---
layout:     post
title:      An introduction to Tensorflex
date:       2018-06-12 00:00:00
summary:    A tutorial explaining how Tensorflex can be used to generate predictions on saved Tensorflow graph models  
categories: gsoc
---


{% highlight python %}
{% endhighlight %}

# The aim of this blog post

This blog post serves to function as a tutorial for using the project I have been working on as part of Google Summer of Code, called Tensorflex. Tensorflex is a bridge to Tensorflex, Google's machine learning framework. Follow the work on Github [here](https://github.com/anshuman23/tensorflex) and star the repository if it helps you out!

This post will first touch upon using Python for training and saving models and then on how to make predicitions from the saved model using Tensorflex. 

## Tensorflow and Tensorflex
- Tensorflow is Google's machine learning framework and is the de-facto standard for training models and making predictions in industry and academia (along with PyTorch). 
- The best way to use Tensorflow for training models is through Python. The C++ API can also be used but is generally more cumbersome and low-level than needed. Moreover, documentation for the Tensorflow Python API is the most easy to read and understand
- Tensorflex are the Tensorflow bindings for Elixir. They are based on the Tensorflow C API which only supports making predictions from saved models at the moment.
- Tensorflex can be used for making predictions in Elixir from trained models written in Python.
- The first half of this post covers using Python for training a simple neural network model on the widely known [Iris dataset](https://archive.ics.uci.edu/ml/datasets/iris)
- The second half covers making predictions from a set of inputs using Tensorflex

## Introduction to computational graphs

<div style="text-align:center" markdown="1">
![alt text](http://www.columbia.edu/~ahd2125/static/img/2015-12-05/Fig1.png)
</div>

Computational graphs form the basis for how Tensorflow works. The figure shown above is an example of a computational graph. As is evident, a graph consists of a set of operations that are performed on the inputs provided to the graph. Tensorflow uses this graph to:
- describe the architecture for your machine learning model
- save this graph (after training) so that predictions can be made by performing the same set of actions (read "operations) for the input provided at the moment

Therefore, without too much further ado, we now discuss the dataset to be used for our ML model, the Python Tensorflow code and then Tensorflex.

## The Iris dataset
This is perhaps the best known database to be found in the pattern recognition literature. Fisher's paper is a classic in the field and is referenced frequently to this day. (See Duda & Hart, for example.) The data set contains 3 classes of 50 instances each, where each class refers to a type of iris plant. One class is linearly separable from the other 2; the latter are NOT linearly separable from each other. The predicted attribute is the class of iris plant. 

- Attribute Information:
  - sepal length in cm 
  - sepal width in cm 
  - petal length in cm 
  - petal width in cm 
  - class: 
    - Iris Setosa 
    - Iris Versicolour 
    - Iris Virginica
    
The model can be downloaded as a CSV file [here](https://github.com/anshuman23/tensorflex/blob/master/examples/iris-example/dataset.csv) 

## Python code for training a simple model on the Iris dataset

The entire code that is to follow is available as an example in the Tensorflex repository. Here is the [link](https://github.com/anshuman23/tensorflex/tree/master/examples/iris-example). Although, by just cloning the Tensorflex repository, you can navigate to the `examples/iris-example` folder and run the example directly from there.

## Generating predictions in Elixir using Tensorflex

## Conclusion

